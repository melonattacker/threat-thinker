{
  "generated_at": "2025-11-26T23:52:38.300994+00:00Z",
  "count": 10,
  "threats": [
    {
      "id": "T001",
      "title": "Potential Credential Theft at Ingress Point",
      "stride": [
        "Spoofing",
        "Information Disclosure"
      ],
      "severity": "High",
      "score": 8.0,
      "affected": [
        "User",
        "CloudFront"
      ],
      "why": "Credentials are transmitted from users to CloudFront; if HTTPS is misconfigured, credentials could be intercepted.",
      "recommended_action": "Ensure HTTPS with strong TLS configuration is enforced at CloudFront and all credentials are transmitted securely.",
      "references": [
        "ASVS V2.1",
        "ASVS V9.1",
        "CWE-522"
      ],
      "evidence": {
        "nodes": [
          "user",
          "cloudfront"
        ],
        "edges": [
          "user->cloudfront"
        ]
      },
      "confidence": 0.9
    },
    {
      "id": "T002",
      "title": "Unencrypted Traffic Between Load Balancer and ECS Service Exposes Sensitive Data",
      "stride": [
        "Information Disclosure",
        "Tampering"
      ],
      "severity": "High",
      "score": 8.0,
      "affected": [
        "Application Load Balancer",
        "ECS Service (Fargate)"
      ],
      "why": "HTTP (unencrypted) is used between the load balancer and ECS, risking exposure or manipulation of PII/internal data in transit.",
      "recommended_action": "Enforce HTTPS/TLS 1.2+ for all internal traffic between the load balancer and ECS service.",
      "references": [
        "ASVS V9.1",
        "CWE-319"
      ],
      "evidence": {
        "nodes": [
          "application_load_balancer",
          "ecs_service_fargate"
        ],
        "edges": [
          "application_load_balancer->ecs_service_fargate"
        ]
      },
      "confidence": 0.95
    },
    {
      "id": "T003",
      "title": "Lack of End-to-End Encryption for PII to Database",
      "stride": [
        "Information Disclosure"
      ],
      "severity": "High",
      "score": 7.0,
      "affected": [
        "ECS Service (Fargate)",
        "Aurora (RDS)"
      ],
      "why": "PII is sent over TCP from ECS to Aurora RDS, which may not be encrypted if not explicitly configured.",
      "recommended_action": "Enable TLS encryption for database connections and enforce encrypted client connections.",
      "references": [
        "ASVS V9.1",
        "ASVS V10.4.1",
        "CWE-319"
      ],
      "evidence": {
        "nodes": [
          "ecs_service_fargate",
          "aurora_rds"
        ],
        "edges": [
          "ecs_service_fargate->aurora_rds"
        ]
      },
      "confidence": 0.85
    },
    {
      "id": "T004",
      "title": "Exposure of Internal Data via S3 Bucket Misconfiguration",
      "stride": [
        "Information Disclosure"
      ],
      "severity": "Medium",
      "score": 6.0,
      "affected": [
        "S3 Bucket (assets)"
      ],
      "why": "Internal data stored in S3 could be exposed if bucket policies or ACLs are misconfigured.",
      "recommended_action": "Restrict S3 bucket access using least privilege IAM policies and enable bucket encryption.",
      "references": [
        "ASVS V9.4",
        "ASVS V10.5.1",
        "CWE-200"
      ],
      "evidence": {
        "nodes": [
          "s3_bucket_assets"
        ],
        "edges": [
          "ecs_service_fargate->s3_bucket_assets"
        ]
      },
      "confidence": 0.85
    },
    {
      "id": "T005",
      "title": "Insufficient Authentication Between Internal Services",
      "stride": [
        "Elevation of Privilege",
        "Spoofing"
      ],
      "severity": "Medium",
      "score": 6.0,
      "affected": [
        "Application Load Balancer",
        "ECS Service (Fargate)"
      ],
      "why": "No explicit authentication is described between the load balancer and ECS, risking unauthorized access if internal boundaries are breached.",
      "recommended_action": "Implement mutual TLS or signed tokens for authentication between internal services.",
      "references": [
        "ASVS V2.1",
        "ASVS V2.2",
        "CWE-287"
      ],
      "evidence": {
        "nodes": [
          "application_load_balancer",
          "ecs_service_fargate"
        ],
        "edges": [
          "application_load_balancer->ecs_service_fargate"
        ]
      },
      "confidence": 0.8
    },
    {
      "id": "T006",
      "title": "Denial of Service Risk at Public Ingress Points",
      "stride": [
        "Denial of Service"
      ],
      "severity": "Medium",
      "score": 5.0,
      "affected": [
        "CloudFront",
        "Application Load Balancer"
      ],
      "why": "Publicly exposed CloudFront and ALB endpoints could be targeted by volumetric or application-layer DoS attacks.",
      "recommended_action": "Implement AWS WAF, rate limiting, and auto-scaling to mitigate DoS risks.",
      "references": [
        "ASVS V1.7",
        "ASVS V9.5",
        "CWE-400"
      ],
      "evidence": {
        "nodes": [
          "cloudfront",
          "application_load_balancer"
        ],
        "edges": [
          "cloudfront->application_load_balancer"
        ]
      },
      "confidence": 0.8
    },
    {
      "id": "T007",
      "title": "Insufficient Access Controls on Internal AWS Resources",
      "stride": [
        "Elevation of Privilege"
      ],
      "severity": "Medium",
      "score": 5.0,
      "affected": [
        "S3 Bucket (assets)",
        "SQS Queue (jobs)",
        "SNS Topic (events)",
        "Aurora (RDS)"
      ],
      "why": "If IAM roles/policies are overly permissive, attackers could escalate privileges or access sensitive resources.",
      "recommended_action": "Review and enforce least privilege IAM roles and resource policies for all AWS resources.",
      "references": [
        "ASVS V4.2",
        "ASVS V4.3",
        "CWE-269"
      ],
      "evidence": {
        "nodes": [
          "s3_bucket_assets",
          "sqs_queue_jobs",
          "sns_topic_events",
          "aurora_rds"
        ],
        "edges": []
      },
      "confidence": 0.75
    },
    {
      "id": "T008",
      "title": "Lack of Audit Logging for Sensitive Operations",
      "stride": [
        "Repudiation"
      ],
      "severity": "Medium",
      "score": 5.0,
      "affected": [
        "ECS Service (Fargate)",
        "Aurora (RDS)",
        "S3 Bucket (assets)"
      ],
      "why": "No evidence of audit logging for access to PII or internal data, risking undetected misuse or data breaches.",
      "recommended_action": "Enable detailed audit logging for all sensitive data access and changes, and monitor logs for anomalies.",
      "references": [
        "ASVS V10.1.1",
        "ASVS V10.2.1",
        "CWE-778"
      ],
      "evidence": {
        "nodes": [
          "ecs_service_fargate",
          "aurora_rds",
          "s3_bucket_assets"
        ],
        "edges": [
          "ecs_service_fargate->aurora_rds",
          "ecs_service_fargate->s3_bucket_assets"
        ]
      },
      "confidence": 0.7
    },
    {
      "id": "T009",
      "title": "Potential for Message Tampering or Replay in SQS/SNS",
      "stride": [
        "Tampering",
        "Repudiation"
      ],
      "severity": "Medium",
      "score": 5.0,
      "affected": [
        "ECS Service (Fargate)",
        "SQS Queue (jobs)",
        "SNS Topic (events)",
        "Lambda Worker"
      ],
      "why": "Internal data sent via SQS/SNS could be tampered with or replayed if message integrity and authentication are not enforced.",
      "recommended_action": "Enable message signing, enforce authentication, and use idempotency tokens for message processing.",
      "references": [
        "ASVS V10.5.2",
        "ASVS V10.6.1",
        "CWE-345"
      ],
      "evidence": {
        "nodes": [
          "ecs_service_fargate",
          "sqs_queue_jobs",
          "sns_topic_events",
          "lambda_worker"
        ],
        "edges": [
          "ecs_service_fargate->sqs_queue_jobs",
          "sns_topic_events->lambda_worker"
        ]
      },
      "confidence": 0.75
    },
    {
      "id": "T010",
      "title": "Lack of Input Validation on User-Provided Data",
      "stride": [
        "Tampering",
        "Elevation of Privilege"
      ],
      "severity": "Low",
      "score": 3.0,
      "affected": [
        "ECS Service (Fargate)"
      ],
      "why": "No explicit input validation is described, risking injection or privilege escalation via crafted user input.",
      "recommended_action": "Implement strict input validation and sanitization for all user-supplied data.",
      "references": [
        "ASVS V5.3",
        "ASVS V5.4",
        "CWE-20"
      ],
      "evidence": {
        "nodes": [
          "ecs_service_fargate"
        ],
        "edges": [
          "application_load_balancer->ecs_service_fargate"
        ]
      },
      "confidence": 0.65
    }
  ],
  "import_metrics": {
    "total_lines": 164367,
    "edge_candidates": 8,
    "edges_parsed": 8,
    "node_label_candidates": 9,
    "node_labels_parsed": 9,
    "import_success_rate": 1.0
  },
  "graph": {
    "nodes": [
      {
        "id": "user",
        "label": "User",
        "zone": "Internet",
        "type": "actor",
        "data": [
          "Credentials"
        ],
        "auth": null,
        "notes": null
      },
      {
        "id": "cloudfront",
        "label": "CloudFront",
        "zone": "DMZ",
        "type": "ingress",
        "data": [
          "Credentials"
        ],
        "auth": true,
        "notes": null
      },
      {
        "id": "application_load_balancer",
        "label": "Application Load Balancer",
        "zone": "DMZ",
        "type": "elb",
        "data": [],
        "auth": null,
        "notes": null
      },
      {
        "id": "ecs_service_fargate",
        "label": "ECS Service (Fargate)",
        "zone": "VPC-Private",
        "type": "service",
        "data": [
          "PII",
          "Internal"
        ],
        "auth": true,
        "notes": null
      },
      {
        "id": "s3_bucket_assets",
        "label": "S3 Bucket (assets)",
        "zone": "AWS-Managed",
        "type": "s3",
        "data": [
          "Internal"
        ],
        "auth": true,
        "notes": null
      },
      {
        "id": "aurora_rds",
        "label": "Aurora (RDS)",
        "zone": "AWS-Managed",
        "type": "database",
        "data": [
          "PII"
        ],
        "auth": true,
        "notes": null
      },
      {
        "id": "sqs_queue_jobs",
        "label": "SQS Queue (jobs)",
        "zone": "AWS-Managed",
        "type": "queue",
        "data": [
          "Internal"
        ],
        "auth": true,
        "notes": null
      },
      {
        "id": "lambda_worker",
        "label": "Lambda Worker",
        "zone": "AWS-Managed",
        "type": "lambda",
        "data": [
          "Internal"
        ],
        "auth": true,
        "notes": null
      },
      {
        "id": "sns_topic_events",
        "label": "SNS Topic (events)",
        "zone": "AWS-Managed",
        "type": "service",
        "data": [
          "Internal"
        ],
        "auth": true,
        "notes": null
      }
    ],
    "edges": [
      {
        "src": "user",
        "dst": "cloudfront",
        "label": "HTTPS, Credentials",
        "protocol": "HTTPS",
        "data": [
          "Credentials"
        ]
      },
      {
        "src": "cloudfront",
        "dst": "application_load_balancer",
        "label": "HTTPS",
        "protocol": "HTTPS",
        "data": []
      },
      {
        "src": "application_load_balancer",
        "dst": "ecs_service_fargate",
        "label": "HTTP",
        "protocol": "HTTP",
        "data": []
      },
      {
        "src": "ecs_service_fargate",
        "dst": "s3_bucket_assets",
        "label": "HTTPS, Internal Data",
        "protocol": "HTTPS",
        "data": [
          "Internal"
        ]
      },
      {
        "src": "ecs_service_fargate",
        "dst": "sqs_queue_jobs",
        "label": "HTTPS, Internal Data",
        "protocol": "HTTPS",
        "data": [
          "Internal"
        ]
      },
      {
        "src": "ecs_service_fargate",
        "dst": "aurora_rds",
        "label": "TCP, PII Data",
        "protocol": "TCP",
        "data": [
          "PII"
        ]
      },
      {
        "src": "sqs_queue_jobs",
        "dst": "lambda_worker",
        "label": "HTTPS, Internal Data",
        "protocol": "HTTPS",
        "data": [
          "Internal"
        ]
      },
      {
        "src": "sns_topic_events",
        "dst": "lambda_worker",
        "label": "HTTPS, Internal Data",
        "protocol": "HTTPS",
        "data": [
          "Internal"
        ]
      }
    ]
  }
}