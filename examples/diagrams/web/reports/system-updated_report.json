{
  "generated_at": "2025-11-26T23:54:42.084766+00:00Z",
  "count": 5,
  "threats": [
    {
      "id": "T001",
      "title": "Lack of Authentication on Internal Services (Cache, Logs, Analytics, Monitor, Alerts)",
      "stride": [
        "Elevation of Privilege",
        "Tampering"
      ],
      "severity": "High",
      "score": 8.0,
      "affected": [
        "cache",
        "logs",
        "analytics",
        "monitor",
        "alerts"
      ],
      "why": "Internal services do not require authentication, allowing unauthorized access or manipulation if perimeter controls fail.",
      "recommended_action": "Implement mutual authentication (e.g., mTLS or API keys) for all internal service endpoints.",
      "references": [
        "ASVS V2.1.1",
        "CWE-306"
      ],
      "evidence": {
        "nodes": [
          "cache",
          "logs",
          "analytics",
          "monitor",
          "alerts"
        ],
        "edges": [
          "api->cache",
          "app->logs",
          "logs->analytics",
          "app->monitor",
          "monitor->alerts"
        ]
      },
      "confidence": 0.9
    },
    {
      "id": "T002",
      "title": "Unencrypted Internal Communications to Cache, Logs, Analytics, and Monitor",
      "stride": [
        "Information Disclosure",
        "Tampering"
      ],
      "severity": "High",
      "score": 8.0,
      "affected": [
        "api",
        "cache",
        "app",
        "logs",
        "analytics",
        "monitor"
      ],
      "why": "Several internal edges use 'unknown' protocol, risking sensitive data exposure or tampering if not encrypted.",
      "recommended_action": "Enforce TLS 1.2+ encryption for all internal service communications, including cache, logs, analytics, and monitoring.",
      "references": [
        "ASVS V9.1.1",
        "CWE-319"
      ],
      "evidence": {
        "nodes": [
          "api",
          "cache",
          "app",
          "logs",
          "analytics",
          "monitor"
        ],
        "edges": [
          "api->cache",
          "app->logs",
          "logs->analytics",
          "app->monitor"
        ]
      },
      "confidence": 0.9
    },
    {
      "id": "T003",
      "title": "PII Exposure Risk in Database Communications",
      "stride": [
        "Information Disclosure"
      ],
      "severity": "High",
      "score": 7.0,
      "affected": [
        "app",
        "db"
      ],
      "why": "Database connection uses plain TCP and handles PII, risking data exposure if not encrypted.",
      "recommended_action": "Enforce encrypted database connections (e.g., TLS) and enable encryption at rest for PII data.",
      "references": [
        "ASVS V9.1.1",
        "ASVS V9.4.1",
        "CWE-311"
      ],
      "evidence": {
        "nodes": [
          "app",
          "db"
        ],
        "edges": [
          "app->db"
        ]
      },
      "confidence": 0.8
    },
    {
      "id": "T004",
      "title": "Potential Logging of Sensitive Data Without Proper Controls",
      "stride": [
        "Information Disclosure",
        "Repudiation"
      ],
      "severity": "Medium",
      "score": 6.0,
      "affected": [
        "app",
        "logs",
        "analytics"
      ],
      "why": "Logs and analytics services are unauthenticated and may receive sensitive data without access controls or redaction.",
      "recommended_action": "Implement log data sanitization, restrict log access, and ensure logs do not contain PII or secrets.",
      "references": [
        "ASVS V10.3.1",
        "ASVS V10.4.1",
        "CWE-532"
      ],
      "evidence": {
        "nodes": [
          "app",
          "logs",
          "analytics"
        ],
        "edges": [
          "app->logs",
          "logs->analytics"
        ]
      },
      "confidence": 0.8
    },
    {
      "id": "T005",
      "title": "Insufficient Segmentation Between DMZ and Private Zones",
      "stride": [
        "Elevation of Privilege",
        "Information Disclosure"
      ],
      "severity": "Medium",
      "score": 5.0,
      "affected": [
        "api",
        "app",
        "cache"
      ],
      "why": "API in DMZ can directly access internal services, increasing risk if API is compromised.",
      "recommended_action": "Implement strict network segmentation and firewall rules to limit DMZ-to-Private zone access to only necessary services and ports.",
      "references": [
        "ASVS V1.4.2",
        "CWE-284"
      ],
      "evidence": {
        "nodes": [
          "api",
          "app",
          "cache"
        ],
        "edges": [
          "api->app",
          "api->cache"
        ]
      },
      "confidence": 0.7
    }
  ],
  "import_metrics": {
    "total_lines": 13,
    "edge_candidates": 9,
    "edges_parsed": 9,
    "node_label_candidates": 1,
    "node_labels_parsed": 1,
    "import_success_rate": 1.0
  },
  "graph": {
    "nodes": [
      {
        "id": "user",
        "label": "User",
        "zone": "Internet",
        "type": "actor",
        "data": [],
        "auth": null,
        "notes": ""
      },
      {
        "id": "waf",
        "label": "waf",
        "zone": "DMZ",
        "type": "service",
        "data": [],
        "auth": false,
        "notes": "Web Application Firewall"
      },
      {
        "id": "api",
        "label": "api",
        "zone": "DMZ",
        "type": "service",
        "data": [],
        "auth": true,
        "notes": ""
      },
      {
        "id": "app",
        "label": "app",
        "zone": "Private",
        "type": "service",
        "data": [
          "Internal"
        ],
        "auth": true,
        "notes": ""
      },
      {
        "id": "cache",
        "label": "cache",
        "zone": "Private",
        "type": "cache",
        "data": [
          "Internal"
        ],
        "auth": false,
        "notes": ""
      },
      {
        "id": "db",
        "label": "db",
        "zone": "Private",
        "type": "database",
        "data": [
          "PII"
        ],
        "auth": true,
        "notes": ""
      },
      {
        "id": "logs",
        "label": "logs",
        "zone": "Private",
        "type": "service",
        "data": [
          "Internal"
        ],
        "auth": false,
        "notes": "Application logs"
      },
      {
        "id": "analytics",
        "label": "analytics",
        "zone": "Private",
        "type": "service",
        "data": [
          "Internal"
        ],
        "auth": false,
        "notes": ""
      },
      {
        "id": "monitor",
        "label": "monitor",
        "zone": "Private",
        "type": "service",
        "data": [
          "Internal"
        ],
        "auth": false,
        "notes": "Monitoring system"
      },
      {
        "id": "alerts",
        "label": "alerts",
        "zone": "Private",
        "type": "service",
        "data": [],
        "auth": false,
        "notes": "Alerting/notification"
      }
    ],
    "edges": [
      {
        "src": "user",
        "dst": "waf",
        "label": null,
        "protocol": "HTTPS",
        "data": []
      },
      {
        "src": "waf",
        "dst": "api",
        "label": null,
        "protocol": "HTTPS",
        "data": []
      },
      {
        "src": "api",
        "dst": "app",
        "label": null,
        "protocol": "HTTPS",
        "data": [
          "Internal"
        ]
      },
      {
        "src": "api",
        "dst": "cache",
        "label": null,
        "protocol": "unknown",
        "data": [
          "Internal"
        ]
      },
      {
        "src": "app",
        "dst": "db",
        "label": null,
        "protocol": "TCP",
        "data": [
          "PII"
        ]
      },
      {
        "src": "app",
        "dst": "logs",
        "label": null,
        "protocol": "unknown",
        "data": [
          "Internal"
        ]
      },
      {
        "src": "logs",
        "dst": "analytics",
        "label": null,
        "protocol": "unknown",
        "data": [
          "Internal"
        ]
      },
      {
        "src": "app",
        "dst": "monitor",
        "label": null,
        "protocol": "unknown",
        "data": [
          "Internal"
        ]
      },
      {
        "src": "monitor",
        "dst": "alerts",
        "label": null,
        "protocol": "unknown",
        "data": []
      }
    ]
  }
}