{
  "generated_at": "2025-11-02T11:47:39.425292+00:00Z",
  "count": 5,
  "threats": [
    {
      "id": "T001",
      "title": "Lack of Authentication on API Endpoint",
      "stride": [
        "Spoofing",
        "Elevation of Privilege"
      ],
      "severity": "High",
      "score": 8.0,
      "affected": [
        "api"
      ],
      "why": "API in DMZ lacks authentication, allowing unauthorized access from the Internet.",
      "recommended_action": "Implement strong authentication (e.g., OAuth 2.0, JWT) on the API endpoint.",
      "references": [
        "ASVS V2.1.1",
        "CWE-287"
      ],
      "evidence": {
        "nodes": [
          "api",
          "user"
        ],
        "edges": []
      },
      "confidence": 0.9
    },
    {
      "id": "T002",
      "title": "Unencrypted HTTP Communication Between API and App",
      "stride": [
        "Tampering",
        "Information Disclosure"
      ],
      "severity": "High",
      "score": 8.0,
      "affected": [
        "api",
        "app"
      ],
      "why": "HTTP protocol between 'api' and 'app' in DMZ/Private zones exposes data to interception and tampering.",
      "recommended_action": "Enforce HTTPS with TLS 1.3 for all internal service-to-service communication.",
      "references": [
        "ASVS V9.1.1",
        "CWE-319"
      ],
      "evidence": {
        "nodes": [
          "api",
          "app"
        ],
        "edges": [
          "api->app"
        ]
      },
      "confidence": 0.95
    },
    {
      "id": "T003",
      "title": "No Authentication or Authorization Between App and Database",
      "stride": [
        "Elevation of Privilege",
        "Information Disclosure"
      ],
      "severity": "High",
      "score": 7.0,
      "affected": [
        "app",
        "db"
      ],
      "why": "No authentication or access control is specified for the app-to-db connection, risking unauthorized data access.",
      "recommended_action": "Enforce database authentication and least-privilege access controls for the application.",
      "references": [
        "ASVS V4.1.1",
        "CWE-284"
      ],
      "evidence": {
        "nodes": [
          "app",
          "db"
        ],
        "edges": [
          "app->db"
        ]
      },
      "confidence": 0.85
    },
    {
      "id": "T004",
      "title": "No Input Validation on API Endpoints",
      "stride": [
        "Tampering",
        "Denial of Service"
      ],
      "severity": "Medium",
      "score": 5.0,
      "affected": [
        "api"
      ],
      "why": "API may be vulnerable to injection or malformed input attacks due to missing validation.",
      "recommended_action": "Implement strict input validation and sanitization on all API endpoints.",
      "references": [
        "ASVS V5.3.2",
        "CWE-20"
      ],
      "evidence": {
        "nodes": [
          "api"
        ],
        "edges": []
      },
      "confidence": 0.8
    },
    {
      "id": "T005",
      "title": "Potential Information Disclosure from API in DMZ",
      "stride": [
        "Information Disclosure"
      ],
      "severity": "Medium",
      "score": 5.0,
      "affected": [
        "api"
      ],
      "why": "API in DMZ may expose sensitive internal data if not properly filtered or sanitized.",
      "recommended_action": "Validate and sanitize all API responses to prevent leakage of sensitive information.",
      "references": [
        "ASVS V10.4.1",
        "CWE-200"
      ],
      "evidence": {
        "nodes": [
          "api"
        ],
        "edges": []
      },
      "confidence": 0.8
    }
  ],
  "import_metrics": {
    "total_lines": 5,
    "edge_candidates": 2,
    "edges_parsed": 2,
    "node_label_candidates": 1,
    "node_labels_parsed": 1,
    "import_success_rate": 1.0
  },
  "graph": {
    "nodes": [
      {
        "id": "api",
        "label": "api",
        "zone": "DMZ",
        "type": "service",
        "data": [
          "Internal"
        ],
        "auth": null,
        "notes": null
      },
      {
        "id": "app",
        "label": "app",
        "zone": "Private",
        "type": "service",
        "data": [
          "Internal"
        ],
        "auth": null,
        "notes": null
      },
      {
        "id": "db",
        "label": "db",
        "zone": "Private",
        "type": "database",
        "data": [
          "Internal"
        ],
        "auth": null,
        "notes": null
      },
      {
        "id": "user",
        "label": "User",
        "zone": "Internet",
        "type": "actor",
        "data": [],
        "auth": null,
        "notes": null
      }
    ],
    "edges": [
      {
        "src": "api",
        "dst": "app",
        "label": null,
        "protocol": "HTTP",
        "data": [
          "Internal"
        ]
      },
      {
        "src": "app",
        "dst": "db",
        "label": null,
        "protocol": "TCP",
        "data": [
          "Internal"
        ]
      }
    ]
  }
}