{
  "generated_at": "2025-11-26T23:50:45.243455+00:00Z",
  "count": 5,
  "threats": [
    {
      "id": "T001",
      "title": "Exposure of Sensitive Data in Transit",
      "stride": [
        "Information Disclosure"
      ],
      "severity": "High",
      "score": 8.0,
      "affected": [
        "app",
        "db"
      ],
      "why": "Internal app-to-db communication over TCP may not be encrypted, risking data exposure if the network is compromised.",
      "recommended_action": "Enable TLS encryption for all database connections and disable plaintext access.",
      "references": [
        "ASVS V9.1.1",
        "CWE-319"
      ],
      "evidence": {
        "nodes": [
          "app",
          "db"
        ],
        "edges": [
          "app->db"
        ]
      },
      "confidence": 0.8
    },
    {
      "id": "T002",
      "title": "Potential Lack of Input Validation on API",
      "stride": [
        "Tampering",
        "Elevation of Privilege"
      ],
      "severity": "High",
      "score": 8.0,
      "affected": [
        "api"
      ],
      "why": "APIs exposed to the Internet are common attack vectors for injection if input validation is insufficient (assumed due to lack of detail).",
      "recommended_action": "Implement strict input validation and sanitization on all API endpoints.",
      "references": [
        "ASVS V5.1",
        "CWE-20"
      ],
      "evidence": {
        "nodes": [
          "user",
          "api"
        ],
        "edges": [
          "user->api"
        ]
      },
      "confidence": 0.8
    },
    {
      "id": "T003",
      "title": "Unencrypted Internal API Communication",
      "stride": [
        "Information Disclosure",
        "Tampering"
      ],
      "severity": "High",
      "score": 8.0,
      "affected": [
        "api",
        "app"
      ],
      "why": "The API communicates with the internal app over HTTP, risking interception or tampering if the DMZ is breached.",
      "recommended_action": "Upgrade internal API-to-app communication to HTTPS with TLS 1.2+ and enforce certificate validation.",
      "references": [
        "ASVS V9.1.1",
        "CWE-319"
      ],
      "evidence": {
        "nodes": [
          "api",
          "app"
        ],
        "edges": [
          "api->app"
        ]
      },
      "confidence": 0.9
    },
    {
      "id": "T004",
      "title": "Denial of Service via Unauthenticated API Access",
      "stride": [
        "Denial of Service"
      ],
      "severity": "Medium",
      "score": 6.0,
      "affected": [
        "api"
      ],
      "why": "If API endpoints are not rate-limited or protected, attackers can overwhelm the service (assumed due to lack of detail).",
      "recommended_action": "Implement rate limiting, authentication, and request throttling on all public API endpoints.",
      "references": [
        "ASVS V7.5",
        "CWE-400"
      ],
      "evidence": {
        "nodes": [
          "user",
          "api"
        ],
        "edges": [
          "user->api"
        ]
      },
      "confidence": 0.7
    },
    {
      "id": "T005",
      "title": "Insufficient Authentication on Internal Services",
      "stride": [
        "Elevation of Privilege",
        "Spoofing"
      ],
      "severity": "Medium",
      "score": 6.0,
      "affected": [
        "app",
        "db"
      ],
      "why": "If authentication between internal services is not strong, attackers moving laterally could impersonate trusted components.",
      "recommended_action": "Enforce mutual authentication (e.g., mTLS or signed tokens) between app and db.",
      "references": [
        "ASVS V2.1",
        "CWE-287"
      ],
      "evidence": {
        "nodes": [
          "app",
          "db"
        ],
        "edges": [
          "app->db"
        ]
      },
      "confidence": 0.7
    }
  ],
  "import_metrics": {
    "total_lines": 5,
    "edge_candidates": 3,
    "edges_parsed": 3,
    "node_label_candidates": 1,
    "node_labels_parsed": 1,
    "import_success_rate": 1.0
  },
  "graph": {
    "nodes": [
      {
        "id": "user",
        "label": "User",
        "zone": "Internet",
        "type": "actor",
        "data": [],
        "auth": null,
        "notes": null
      },
      {
        "id": "api",
        "label": "api",
        "zone": "DMZ",
        "type": "service",
        "data": [],
        "auth": true,
        "notes": null
      },
      {
        "id": "app",
        "label": "app",
        "zone": "Private",
        "type": "service",
        "data": [
          "Internal"
        ],
        "auth": true,
        "notes": null
      },
      {
        "id": "db",
        "label": "db",
        "zone": "Private",
        "type": "database",
        "data": [
          "Internal"
        ],
        "auth": true,
        "notes": null
      }
    ],
    "edges": [
      {
        "src": "user",
        "dst": "api",
        "label": null,
        "protocol": "HTTPS",
        "data": []
      },
      {
        "src": "api",
        "dst": "app",
        "label": null,
        "protocol": "HTTP",
        "data": [
          "Internal"
        ]
      },
      {
        "src": "app",
        "dst": "db",
        "label": null,
        "protocol": "TCP",
        "data": [
          "Internal"
        ]
      }
    ]
  }
}